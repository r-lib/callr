<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>External R Session — r_session • callr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="External R Session — r_session"><meta name="description" content="A permanent R session that runs in the background. This is an R6 class
that extends the processx::process class.
The process is started at the creation of the object, and then it can
be used to evaluate R function calls, one at a time."><meta property="og:description" content="A permanent R session that runs in the background. This is an R6 class
that extends the processx::process class.
The process is started at the creation of the object, and then it can
be used to evaluate R function calls, one at a time."><meta name="robots" content="noindex"><script defer data-domain="callr.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">callr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.7.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/r-session.html">Persistent R sessions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Blog posts</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2019/09/callr-task-q">A multi process task queue in 100 lines of R code</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/callr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>External R Session</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/callr/blob/main/R/r-session.R" class="external-link"><code>R/r-session.R</code></a></small>
      <div class="d-none name"><code>r_session.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A permanent R session that runs in the background. This is an R6 class
that extends the <a href="http://processx.r-lib.org/reference/process.html" class="external-link">processx::process</a> class.</p>
<p>The process is started at the creation of the object, and then it can
be used to evaluate R function calls, one at a time.</p>
    </div>


    <div class="section level2">
    <h2 id="super-class">Super class<a class="anchor" aria-label="anchor" href="#super-class"></a></h2>
    <p><code><a href="http://processx.r-lib.org/reference/process.html" class="external-link">processx::process</a></code> -&gt; <code>r_session</code></p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>status</code></dt>
<dd><p>Status codes returned by <code>read()</code>.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-r_session-new"><code>r_session$new()</code></a></p></li>
<li><p><a href="#method-r_session-run"><code>r_session$run()</code></a></p></li>
<li><p><a href="#method-r_session-run_with_output"><code>r_session$run_with_output()</code></a></p></li>
<li><p><a href="#method-r_session-call"><code>r_session$call()</code></a></p></li>
<li><p><a href="#method-r_session-poll_process"><code>r_session$poll_process()</code></a></p></li>
<li><p><a href="#method-r_session-get_state"><code>r_session$get_state()</code></a></p></li>
<li><p><a href="#method-r_session-get_running_time"><code>r_session$get_running_time()</code></a></p></li>
<li><p><a href="#method-r_session-read"><code>r_session$read()</code></a></p></li>
<li><p><a href="#method-r_session-close"><code>r_session$close()</code></a></p></li>
<li><p><a href="#method-r_session-traceback"><code>r_session$traceback()</code></a></p></li>
<li><p><a href="#method-r_session-debug"><code>r_session$debug()</code></a></p></li>
<li><p><a href="#method-r_session-attach"><code>r_session$attach()</code></a></p></li>
<li><p><a href="#method-r_session-print"><code>r_session$print()</code></a></p></li>
<li><p><a href="#method-r_session-clone"><code>r_session$clone()</code></a></p></li>
</ul></div><p><details><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="as_ps_handle"><a href="http://processx.r-lib.org/reference/process.html#method-as_ps_handle"><code>processx::process$as_ps_handle()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="finalize"><a href="http://processx.r-lib.org/reference/process.html#method-finalize"><code>processx::process$finalize()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="format"><a href="http://processx.r-lib.org/reference/process.html#method-format"><code>processx::process$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_cmdline"><a href="http://processx.r-lib.org/reference/process.html#method-get_cmdline"><code>processx::process$get_cmdline()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_cpu_times"><a href="http://processx.r-lib.org/reference/process.html#method-get_cpu_times"><code>processx::process$get_cpu_times()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_error_connection"><a href="http://processx.r-lib.org/reference/process.html#method-get_error_connection"><code>processx::process$get_error_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_error_file"><a href="http://processx.r-lib.org/reference/process.html#method-get_error_file"><code>processx::process$get_error_file()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_exe"><a href="http://processx.r-lib.org/reference/process.html#method-get_exe"><code>processx::process$get_exe()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_exit_status"><a href="http://processx.r-lib.org/reference/process.html#method-get_exit_status"><code>processx::process$get_exit_status()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_input_connection"><a href="http://processx.r-lib.org/reference/process.html#method-get_input_connection"><code>processx::process$get_input_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_input_file"><a href="http://processx.r-lib.org/reference/process.html#method-get_input_file"><code>processx::process$get_input_file()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_memory_info"><a href="http://processx.r-lib.org/reference/process.html#method-get_memory_info"><code>processx::process$get_memory_info()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_name"><a href="http://processx.r-lib.org/reference/process.html#method-get_name"><code>processx::process$get_name()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_output_connection"><a href="http://processx.r-lib.org/reference/process.html#method-get_output_connection"><code>processx::process$get_output_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_output_file"><a href="http://processx.r-lib.org/reference/process.html#method-get_output_file"><code>processx::process$get_output_file()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_pid"><a href="http://processx.r-lib.org/reference/process.html#method-get_pid"><code>processx::process$get_pid()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_poll_connection"><a href="http://processx.r-lib.org/reference/process.html#method-get_poll_connection"><code>processx::process$get_poll_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_result"><a href="http://processx.r-lib.org/reference/process.html#method-get_result"><code>processx::process$get_result()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_start_time"><a href="http://processx.r-lib.org/reference/process.html#method-get_start_time"><code>processx::process$get_start_time()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_status"><a href="http://processx.r-lib.org/reference/process.html#method-get_status"><code>processx::process$get_status()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_username"><a href="http://processx.r-lib.org/reference/process.html#method-get_username"><code>processx::process$get_username()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="get_wd"><a href="http://processx.r-lib.org/reference/process.html#method-get_wd"><code>processx::process$get_wd()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="has_error_connection"><a href="http://processx.r-lib.org/reference/process.html#method-has_error_connection"><code>processx::process$has_error_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="has_input_connection"><a href="http://processx.r-lib.org/reference/process.html#method-has_input_connection"><code>processx::process$has_input_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="has_output_connection"><a href="http://processx.r-lib.org/reference/process.html#method-has_output_connection"><code>processx::process$has_output_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="has_poll_connection"><a href="http://processx.r-lib.org/reference/process.html#method-has_poll_connection"><code>processx::process$has_poll_connection()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="interrupt"><a href="http://processx.r-lib.org/reference/process.html#method-interrupt"><code>processx::process$interrupt()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="is_alive"><a href="http://processx.r-lib.org/reference/process.html#method-is_alive"><code>processx::process$is_alive()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="is_incomplete_error"><a href="http://processx.r-lib.org/reference/process.html#method-is_incomplete_error"><code>processx::process$is_incomplete_error()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="is_incomplete_output"><a href="http://processx.r-lib.org/reference/process.html#method-is_incomplete_output"><code>processx::process$is_incomplete_output()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="is_supervised"><a href="http://processx.r-lib.org/reference/process.html#method-is_supervised"><code>processx::process$is_supervised()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="kill"><a href="http://processx.r-lib.org/reference/process.html#method-kill"><code>processx::process$kill()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="kill_tree"><a href="http://processx.r-lib.org/reference/process.html#method-kill_tree"><code>processx::process$kill_tree()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="poll_io"><a href="http://processx.r-lib.org/reference/process.html#method-poll_io"><code>processx::process$poll_io()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_all_error"><a href="http://processx.r-lib.org/reference/process.html#method-read_all_error"><code>processx::process$read_all_error()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_all_error_lines"><a href="http://processx.r-lib.org/reference/process.html#method-read_all_error_lines"><code>processx::process$read_all_error_lines()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_all_output"><a href="http://processx.r-lib.org/reference/process.html#method-read_all_output"><code>processx::process$read_all_output()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_all_output_lines"><a href="http://processx.r-lib.org/reference/process.html#method-read_all_output_lines"><code>processx::process$read_all_output_lines()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_error"><a href="http://processx.r-lib.org/reference/process.html#method-read_error"><code>processx::process$read_error()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_error_lines"><a href="http://processx.r-lib.org/reference/process.html#method-read_error_lines"><code>processx::process$read_error_lines()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_output"><a href="http://processx.r-lib.org/reference/process.html#method-read_output"><code>processx::process$read_output()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="read_output_lines"><a href="http://processx.r-lib.org/reference/process.html#method-read_output_lines"><code>processx::process$read_output_lines()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="resume"><a href="http://processx.r-lib.org/reference/process.html#method-resume"><code>processx::process$resume()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="signal"><a href="http://processx.r-lib.org/reference/process.html#method-signal"><code>processx::process$signal()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="supervise"><a href="http://processx.r-lib.org/reference/process.html#method-supervise"><code>processx::process$supervise()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="suspend"><a href="http://processx.r-lib.org/reference/process.html#method-suspend"><code>processx::process$suspend()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="wait"><a href="http://processx.r-lib.org/reference/process.html#method-wait"><code>processx::process$wait()</code></a></span></li>
<li><span class="pkg-link" data-pkg="processx" data-topic="process" data-id="write_input"><a href="http://processx.r-lib.org/reference/process.html#method-write_input"><code>processx::process$write_input()</code></a></span></li>
</ul></details></p><hr><a id="method-r_session-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>creates a new R background process. It can wait for the process to
start up (<code>wait = TRUE</code>), or return immediately, i.e. before
the process is actually ready to run. In the latter case you may call
the <code>poll_process()</code> method to make sure it is ready.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/r_session.html">r_session</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>options <span class="op">=</span> <span class="fu"><a href="../reference/r_session_options.html">r_session_options</a></span><span class="op">(</span><span class="op">)</span>, wait <span class="op">=</span> <span class="cn">TRUE</span>, wait_timeout <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>options</code></dt>
<dd><p>A list of options created via <code><a href="r_session_options.html">r_session_options()</a></code>.</p></dd>


<dt><code>wait</code></dt>
<dd><p>Whether to wait for the R process to start and be ready
for running commands.</p></dd>


<dt><code>wait_timeout</code></dt>
<dd><p>Timeout for waiting for the R process to start,
in milliseconds.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>An <code>r_session</code> object.</p>
</div>

</div><p></p><hr><a id="method-r_session-run"></a><div class="section">
<h3 id="method-run-">Method <code><a href="http://processx.r-lib.org/reference/run.html" class="external-link">run()</a></code><a class="anchor" aria-label="anchor" href="#method-run-"></a></h3>
<p>Similar to <code><a href="r.html">r()</a></code>, but runs the function in a permanent background
R session. It throws an error if the function call generated an
error in the child process.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">func</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, package <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>func</code></dt>
<dd><p>Function object to call in the background R process.
Please read the notes for the similar argument of <code><a href="r.html">r()</a></code>.</p></dd>


<dt><code>args</code></dt>
<dd><p>Arguments to pass to the function. Must be a list.</p></dd>


<dt><code>package</code></dt>
<dd><p>Whether to keep the environment of <code>func</code> when passing
it to the other package. Possible values are:</p><ul><li><p><code>FALSE</code>: reset the environment to <code>.GlobalEnv</code>. This is the default.</p></li>
<li><p><code>TRUE</code>: keep the environment as is.</p></li>
<li><p><code>pkg</code>: set the environment to the <code>pkg</code> package namespace.</p></li>
</ul></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>The return value of the R expression.</p>
</div>

</div><p></p><hr><a id="method-r_session-run_with_output"></a><div class="section">
<h3 id="method-run-with-output-">Method <code>run_with_output()</code><a class="anchor" aria-label="anchor" href="#method-run-with-output-"></a></h3>
<p>Similar to <code>$run()</code>, but returns the standard output and error of
the child process as well. It does not throw on errors, but
returns a non-<code>NULL</code> <code>error</code> member in the result list.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">run_with_output</span><span class="op">(</span><span class="va">func</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, package <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>func</code></dt>
<dd><p>Function object to call in the background R process.
Please read the notes for the similar argument of <code><a href="r.html">r()</a></code>.</p></dd>


<dt><code>args</code></dt>
<dd><p>Arguments to pass to the function. Must be a list.</p></dd>


<dt><code>package</code></dt>
<dd><p>Whether to keep the environment of <code>func</code> when passing
it to the other package. Possible values are:</p><ul><li><p><code>FALSE</code>: reset the environment to <code>.GlobalEnv</code>. This is the default.</p></li>
<li><p><code>TRUE</code>: keep the environment as is.</p></li>
<li><p><code>pkg</code>: set the environment to the <code>pkg</code> package namespace.</p></li>
</ul></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A list with the following entries.</p><ul><li><p><code>result</code>: The value returned by <code>func</code>. On error this is <code>NULL</code>.</p></li>
<li><p><code>stdout</code>: The standard output of the process while evaluating</p></li>
<li><p><code>stderr</code>: The standard error of the process while evaluating
the <code>func</code> call.</p></li>
<li><p><code>error</code>: On error it contains an error object, that contains the
error thrown in the subprocess. Otherwise it is <code>NULL</code>.</p></li>
<li><p><code>code</code>, <code>message</code>: These fields are used by call internally and
you can ignore them.</p></li>
</ul></div>

</div><p></p><hr><a id="method-r_session-call"></a><div class="section">
<h3 id="method-call-">Method <code><a href="https://rdrr.io/r/base/call.html" class="external-link">call()</a></code><a class="anchor" aria-label="anchor" href="#method-call-"></a></h3>
<p>Starts running a function in the background R session, and
returns immediately. To check if the function is done, call the
<code>poll_process()</code> method.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">call</span><span class="op">(</span><span class="va">func</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, package <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>func</code></dt>
<dd><p>Function object to call in the background R process.
Please read the notes for the similar argument of <code><a href="r.html">r()</a></code>.</p></dd>


<dt><code>args</code></dt>
<dd><p>Arguments to pass to the function. Must be a list.</p></dd>


<dt><code>package</code></dt>
<dd><p>Whether to keep the environment of <code>func</code> when passing
it to the other package. Possible values are:</p><ul><li><p><code>FALSE</code>: reset the environment to <code>.GlobalEnv</code>. This is the default.</p></li>
<li><p><code>TRUE</code>: keep the environment as is.</p></li>
<li><p><code>pkg</code>: set the environment to the <code>pkg</code> package namespace.</p></li>
</ul></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-r_session-poll_process"></a><div class="section">
<h3 id="method-poll-process-">Method <code>poll_process()</code><a class="anchor" aria-label="anchor" href="#method-poll-process-"></a></h3>
<p>Poll the R session with a timeout. If the session has finished the
computation, it returns with <code>"ready"</code>. If the timeout
is reached, it returns with <code>"timeout"</code>.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">poll_process</span><span class="op">(</span><span class="va">timeout</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>timeout</code></dt>
<dd><p>Timeout period in milliseconds.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>Character string <code>"ready"</code> or <code>"timeout"</code>.</p>
</div>

</div><p></p><hr><a id="method-r_session-get_state"></a><div class="section">
<h3 id="method-get-state-">Method <code>get_state()</code><a class="anchor" aria-label="anchor" href="#method-get-state-"></a></h3>
<p>Return the state of the R session.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">get_state</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>Possible values:</p><ul><li><p><code>"starting"</code>: starting up,</p></li>
<li><p><code>"idle"</code>: ready to compute,</p></li>
<li><p><code>"busy"</code>: computing right now,</p></li>
<li><p><code>"finished"</code>: the R process has finished.</p></li>
</ul></div>

</div><p></p><hr><a id="method-r_session-get_running_time"></a><div class="section">
<h3 id="method-get-running-time-">Method <code>get_running_time()</code><a class="anchor" aria-label="anchor" href="#method-get-running-time-"></a></h3>
<p>Returns the elapsed time since the R process has started, and the
elapsed time since the current computation has started. The latter
is <code>NA</code> if there is no active computation.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">get_running_time</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>Named vector of <code>POSIXct</code> objects. The names are <code>"total"</code>
and <code>"current"</code>.</p>
</div>

</div><p></p><hr><a id="method-r_session-read"></a><div class="section">
<h3 id="method-read-">Method <code>read()</code><a class="anchor" aria-label="anchor" href="#method-read-"></a></h3>
<p>Reads an event from the child process, if there is one available.
Events might signal that the function call has finished, or they
can be progress report events.</p>
<p>This is a low level function that you only need to use if you
want to process events (messages) from the R session manually.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">read</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p><code>NULL</code> if no events are available. Otherwise a named list,
which is also a <code>callr_session_result</code> object. The list always has
a <code>code</code> entry which is the type of the event. See also
<code>r_session$public_fields$status</code> for symbolic names of the
event types.</p><ul><li><p><code>200</code>: (<code>DONE</code>) The computation is done, and the event includes
the result, in the same form as for the <code><a href="http://processx.r-lib.org/reference/run.html" class="external-link">run()</a></code> method.</p></li>
<li><p><code>201</code>: (<code>STARTED</code>) An R session that was in 'starting' state is
ready to go.</p></li>
<li><p><code>202</code>: (<code>ATTACH_DONE</code>) Used by the <code><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach()</a></code> method.</p></li>
<li><p><code>301</code>: (<code>MSG</code>) A message from the subprocess. The message is a
condition object with class <code>callr_message</code>. (It typically has
other classes, e.g. <code>cli_message</code> for output from the cli
package.)</p></li>
<li><p><code>500</code>: (<code>EXITED</code>) The R session finished cleanly. This means
that the evaluated expression quit R.</p></li>
<li><p><code>501</code>: (<code>CRASHED</code>) The R session crashed or was killed.</p></li>
<li><p><code>502</code>: (<code>CLOSED</code>) The R session closed its end of the connection
that callr uses for communication.</p></li>
</ul></div>

</div><p></p><hr><a id="method-r_session-close"></a><div class="section">
<h3 id="method-close-">Method <code><a href="https://rdrr.io/r/base/connections.html" class="external-link">close()</a></code><a class="anchor" aria-label="anchor" href="#method-close-"></a></h3>
<p>Terminate the current computation and the R process.
The session object will be in <code>"finished"</code> state after this.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">close</span><span class="op">(</span>grace <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>grace</code></dt>
<dd><p>Grace period in milliseconds, to wait for the
subprocess to exit cleanly, after its standard input is closed.
If the process is still running after this period, it will be
killed.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-r_session-traceback"></a><div class="section">
<h3 id="method-traceback-">Method <code><a href="https://rdrr.io/r/base/traceback.html" class="external-link">traceback()</a></code><a class="anchor" aria-label="anchor" href="#method-traceback-"></a></h3>
<p>The <code><a href="https://rdrr.io/r/base/traceback.html" class="external-link">traceback()</a></code> method can be used after an error in the R
subprocess. It is equivalent to the <code><a href="https://rdrr.io/r/base/traceback.html" class="external-link">base::traceback()</a></code> call, in
the subprocess.</p>
<p>On callr version 3.8.0 and above, you need to set the
<code>callr.traceback</code> option to <code>TRUE</code> (in the main process) to make
the subprocess save the trace on error. This is because saving
the trace can be costly for large objects passed as arguments.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">traceback</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>The same output as from <code><a href="https://rdrr.io/r/base/traceback.html" class="external-link">base::traceback()</a></code></p>
</div>

</div><p></p><hr><a id="method-r_session-debug"></a><div class="section">
<h3 id="method-debug-">Method <code><a href="https://rdrr.io/r/base/debug.html" class="external-link">debug()</a></code><a class="anchor" aria-label="anchor" href="#method-debug-"></a></h3>
<p>Interactive debugger to inspect the dumped frames in the subprocess,
after an error. See more at <a href="r_session_debug.html">r_session_debug</a>.</p>
<p>On callr version 3.8.0 and above, you need to set the
<code>callr.traceback</code> option to <code>TRUE</code> (in the main process) to make
the subprocess dump frames on error. This is because saving
the frames can be costly for large objects passed as arguments.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">debug</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-r_session-attach"></a><div class="section">
<h3 id="method-attach-">Method <code><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach()</a></code><a class="anchor" aria-label="anchor" href="#method-attach-"></a></h3>
<p>Experimental function that provides a REPL
(Read-Eval-Print-Loop) to the subprocess.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="kw">attach</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-r_session-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Print method for an <code>r_session</code>.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Arguments are not used currently.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-r_session-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">r_session</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="va">r_session</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rs</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rs</span><span class="op">$</span><span class="fu">call</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs</span><span class="op">$</span><span class="fu">get_state</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rs</span><span class="op">$</span><span class="fu">poll_process</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs</span><span class="op">$</span><span class="fu">get_state</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs</span><span class="op">$</span><span class="fu">read</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/gaborcsardi" class="external-link">Gábor Csárdi</a>, <a href="https://github.com/wch" class="external-link">Winston Chang</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>, Ascent Digital Services.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

